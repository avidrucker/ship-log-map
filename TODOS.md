# To-Do's

- [ ] Implement animation of nodes appearing
- [ ] Implement animation of edges connecting one node to another
- [ ] Implement "question mark" nodes that can be transformed into specific nodes
- [ ] Implement context menu to replace current UI for adding/removing nodes, edges, renaming nodes, etc.
- [x] Implement a "save" button to save the current graph state
- [x] Implement a "load" button to load a previously saved graph state
- [x] Implement a "new" button to clear the current graph state and start fresh with zero nodes, edges, and the camera is reset to the default position and zoom
- [x] Implement a "debug" button to log the current graph state to the console
- [x] Change selected node outline/border color to be the node's bright color instead of white
- [x] Implement a "delete" button to remove the currently selected node and all its edges
- [x] Implement a "rename" button to rename the currently selected node
- [x] Implement a "connect" button to connect the currently selected node to another node
- [x] Implement a "play mode" button which hides the UI and allows the user to interact with the graph without editing it
- [x] Implement an explicit "edit mode" button which shows the UI and allows the user to edit the graph
- [x] Implement a "zoom to node" feature which zooms the camera to the currently selected node, centering it in the viewport and zooming in to a comfortable reading/viewing level (this zoom amount should vary depending on the node size)
- [x] Implement adding of clues/hints to edges, which can be displayed when an edge is clicked
- [x] Implement adding of clues/hints to nodes, which can be displayed when a node is clicked
- [x] **Pressing Esc while a modal is open should close the modal (for both note editor and node renaming)**
- ~~Selecting a node will deselect all edges~~
- ~~Selecting an edge will deselect all nodes~~
- [x] Clicking outside of the Note Editor Modal closes it, including when clicking on the background or other nodes/edges
- [x] Fix bug where edges are not properly styled when they are selected
- [x] Implement "double-edges" where each edge has a second edge below it with a thicker line and different color to mimic source material styling
- [x] See if arrows can be moved to the center of edges instead of being at the end
- [x] Fix focused/active nodes to not have different border colors (they should match the node's color always)
- [x] Change cursor to pointer when hovering over nodes and edges
- ~~Implement re-ordering of notes in the Note Editor Modal~~
- [ ] Implement "unlocking" of nodes in player mode where initially a question mark is shown on the node instead of its title and picture to indicate that a node exists, but is not yet accessible
- [ ] Implement "unlocking" of notes where, in the note viewer modal, there is an indicator that further notes exist, but are not yet accessible, and then, that indicator goes away when all existing notes are found/discovered/shown
- [x] Fix node and edge selection so that single clicking adds to the selection (instead of requiring shift+click) and clicking on the background deselects all nodes and edges
- [x] fix colors to match original source material
- [x] Implement typewriter effect for notes in the Note Viewer Modal
- [x] Clicking on the background seems to not deselect nodes and edges properly, fix this (issue was that renaming nodes/edges was accidentally desync'ing the selection state)
- [x] Implement "last graph state" and undo button so that accidental deletions can be undone
- ~~Implement z-depth order where changing anything about a node (it's location, size, color, etc.) will move it to the top of the z-order so that it is always on top of other nodes and edges~~
- [x] Make smaller nodes have a higher z-depth so that they are not hidden behind larger nodes
- [ ] Implement "tags" that enable overlays so that way nodes can be grouped by tags and the user can toggle visibility of nodes based on their tags (e.g. "play", "sleep/beds", "eat/food", "poop", "shower", "Internet/Ethernet/Wi-Fi", "filtered water", "unfiltered water", "upper water system", "lower water system", "first day", "first week", etc.)
- [x] Implement a "search" feature that allows users to search for nodes by title
- [ ] Implement a "filter" feature that allows users to filter nodes by tags, size, color, etc.
- [x] Implement a "Are you sure you want to delete the current map?" confirmation popup upon clicking the reset button so that way users don't accidentally reset their graph
- [ ] Implement a button in the note editor modal that clears the current image from the selected node (in the note editor modal), and resets the node's image to the default "unspecified" image
- [x] Implement rotate map feature that rotates the entire map by 90 degrees clockwise or counter-clockwise around its center point or the origin point (0,0)
- [x] Apply zooming into a node/edge when it is selected in playing mode, so that the camera zooms in on the node/edge and centers it in the top half of the viewport
- [x] Fix bug where nodes are draggable in playing mode, they should not be draggable in playing mode
- [x] Investigate bug where images are not loaded correctly from the CDN, only showing 1 of the images for all the nodes
- [x] Implement toggle-able overlay via a button in the UI that, when toggled, shows/hides a number above each node indicating the number of notes associated with that node
- [x] Fix bug where edge double clicking doesn't cycle through edge directions properly, but it should cycle through forward, backward, bidirectional, and then back to forward
- [x] Fix animation bug when in playing mode and unzooming out of a node/edge, where the animation plays 3 times when it should only play once ONLY if the user clicks on the background to unzoom, but if the user clicks on the "x" button to close the note viewer modal, it correctly plays the animation only once
- [x] Remove undo button from playing mode, as it is not needed there
- [x] Fix bug where double clicking a node in playing mode changes the node's size, but it should not change the size of the node in playing mode
- [x] Fix bug where loading from a JSON file does not update the CDN link, but it should
- [x] Implementing a "map name" feature that allows users to set a name for the current map, which is saved with the graph state and can be displayed in the UI
- [x] Increase the size of the edge arrow chevrons to make them more visible and more closely match the original source material
- [x] Fix bug where entry nodes that are selected do not currently display their bright color, but they should
- [x] Implement different size (or different font-size) note-count nodes that associate with the different sizes of the entry nodes they are associated with so that larger entry nodes have larger note-count nodes and smaller entry nodes have smaller note-count nodes
- [x] Fix the undo button which doesn't seem to be restoring nodes after they have been moved
- [ ] Implement an icon system that allows users to select from a set of icons for nodes, which can be used to visually represent the type of node (e.g. a bed icon for sleep nodes, a shower icon for hygiene nodes, etc.) that uses font awesome 4.7 icons
- [x] Implement the usage (loading from CDN, caching, and displaying) of an optional placeholder SVG image that can live in the CDN and get cached into the app, where, if the image exists in the specified CDN folder and/or is cached, it will be the default placeholder SVG image icon for nodes that do not have an image set, and if a default_image.svg image does not exist in the CDN (or cache), then the app will use the default app's built-in "unspecified" SVG image instead. The name of the file in the CDN, if it exists, will be "default_image.svg". Clearing the cache will remove this image from the cache, and the app will revert to using the built-in "unspecified" SVG image, but refreshing the page will trigger an attempt to reload the "default_image.svg" from the CDN again
- ~~IDEA: Implement toggle which switches between showing node titles and showing secondary text labels for nodes, where the secondary text labels are set in the node's data and can be used to show additional information about the node (e.g. an alternate language title, etc.)~~
- ~~Implement a 3rd node type which displays "tags" for nodes, where the tags are displayed as small text labels below the node title and can be used to categorize nodes (e.g. "play", "sleep", "eat", etc.), and the data structure for the node will include a "tags" array that contains the tags for the node~~
  - ~~IDEA 1: and the editor modal will allow users to add/remove tags from the selected node, in which the tags are displayed as buttons that can be toggled on and off to add/remove them from the selected node~~
  - ~~IDEA 2: and there will be a second select dropdown (similar to the color select dropdown) which allows users to select tags to add/remove from the current node selection, plus the option to manage tags via a new "manage tags" select option that toggles open the "manage tags" modal~~
- [ ] Implement a "manage tags" modal that allows users to create, edit, and delete tags
- [ ] Implement a "manage icons" modal that allows users to select from a set of icons for tags, which can be used to visually represent a given tag (e.g. a bed icon for the "sleep" tag, a shower icon for the "showers" tag, etc.)
- [ ] IDEA: Implement deselecting of nodes and edges when clicking on the close modal button as well as pressing the Esc key when the note editor modal is open, so that the user can close the modal *and* deselect the node without having to click on the background
- [x] Move rotate button to the bottom left panel because it is useful in all modes, not just editing mode
- [x] Add a compass rose to the map that shows the cardinal directions (N, S, E, W) and can be toggled on and off
- ~~IDEA: Temporarily add map nodes which indicate the cardinal directions (north point of map, east point, etc.)~~
- [x] Implement sharable maps via query params, where, the map can be shared via a URL that points at the map's JSON file in the CDN and will load the map from that URL when the app is opened with those query params, for example, the CDN https://avidrucker.github.io/img-test-1/Gaia%20Yoga will be accessed by the app when the user opens the app with the URL https://avidrucker.github.io/ship-log-map/?map=https://avidrucker.github.io/img-test-1/Gaia%20Yoga/gaia_yoga.json where the map query param is the URL of the map's JSON file in the CDN constructed by the app address (https://avidrucker.github.io/ship-log-map/) and the map's CDN file URL (https://avidrucker.github.io/img-test-1/Gaia%20Yoga/) plus the map's JSON file name (gaia_yoga.json). If a map query param is not provided, the app will default to loading the map from the hard-coded example map JSON file in the app (e.g. https://avidrucker.github.io/ship-log-map/example_map.json). Changing the CDN, or the map name, or loading in a new map from a JSON file, will update the map query param in the URL to reflect the new map's JSON file URL in the CDN.
- ~~Implement below the CDN link display/edit field the display of the current map URL with query params to load the current map from its CDN, so that, when the user clicks on it, it copies the link so they can easily share it with others, and the link will be in the format of https://avidrucker.github.io/ship-log-map/?map=https://avidrucker.github.io/img-test-1/Gaia%20Yoga/gaia_yoga.json (app_link + ?map= + map_cdn_url + map_json_file_name)~~
- ~~Update the Reset button to revert to the JSON map from the specified CDN rather than the current hard-coded example map~~
- [x] Implement importing of an image overlay from the CDN or just in memory that can be toggled on and off, moved, and resized, which can be used to display a background image for the map (e.g. a floor plan, etc.)
- [x] Fix undo button so that, when creating new nodes, or changing the graph state otherwise, a refresh of the page is not necessary to see the visual reversal of the last action (i.e. the undo button should immediately revert the graph state to the previous state without requiring a refresh)
- [x] Fix reocurring bug where clicking outside of the Note Viewer Modal plays the "zoom back" animation twice currently (note, this doesn't happen when clicking the "x" button to close the modal, only when clicking outside of the modal, and it doesn't happen for the note editor modal, only the note viewer modal))
- ~~Fix bug where refreshing the page with query params always resets the camera back to a fitted zoom and pan, when it should instead keep the current in-app camera position and zoom level, unless loading from an entirely new map~~
- [x] Implement sharing where, in the sharing modal, the user can copy a second newly available link which will add a query param of "editing=true" which will enable editing mode for the map when it is loaded. Also, when there are no query params, the app will have editing mode (and mode switching) enabled. To reiterate, if the app is has query params and the editing query param is not set to true, then the app will load the map in playing mode only and will not allow mode switching.
- [x] Fix bug where, loading in a new map from the CDN doesn't appear to update the compass visibility/direction
- [ ] Implement conflict resolution modal that informs the user if the graph data from CDN and the graph data (names, node locations, edge directions, node count, edge count, node color, node size, etc.) in local storage differ, and if so, which map would they like to continue with, and update local storage with CDN graph data if the user chooses the CDN graph as well as update the app visually the graph data from the CDN
- [x] Fix bug where, for example, when working in local dev map http://localhost:5173/ship-log-map/?map=https%3A%2F%2Favidrucker.github.io%2Fimg-test-1%2FGaia%2520Yoga%2Fgaia_yoga.json&canedit=true that, on page refresh, the app resets the camera to fit the map instead of keeping the current camera position and zoom level, and also reverts the compass display back to the CDN state instead of keeping the current (local storage saved) compass display state
- [x] Implement a "Reload" button in the Universal Controls that fully reloads the current map from the specified CDN URL, which can be used to discard any unsaved changes and revert to the last saved state in the CDN
- [x] Create icon for the app
  - [x] Add new icon to the app
- [x] Enhance the app so it can work offline via service workers
- [x] Add to dev mode debug modal two buttons, one to load the Outer Wilds map from the CDN and one to load the Gaia Yoga map from the CDN, which will update the CDN URL field in the UI and load the selected map from the CDN
- [x] Conditionally hide "Load CDN" button in Universal Controls when there is no CDN URL specified
- [x] Fix "Create New Map" (just called "New" in the app) button not deleting, clearing, and reseting the background image underlay data if one is set
- [x] Fix "Zooming In To Node/Edge" not yet scaling & panning the background image (but it should)
- [x] Fix issue where FF7 bg image settings are not correctly saved to JSON and thus not reloaded properly from JSON
- [x] Fix bug where first load of the page doesn't load in the image assets, but it should
- [x] Implement showing of Note Counts on edges too (right now, edges can hold notes, but when in "Notes ON" mode, numbers are not yet shown)
- [ ] Switch from using 100x100 jpeg thumbnails to larger 500x500 webp images
- [ ] Experiment with using composite images as tilesheets/spritesheets to improve performance and loading times
- [ ] Create "update history" which, in editing mode, simply shows what changes have been made to the map since it was last loaded (e.g. moved "Node A" from (x,y) to (x',y') OR "added picture to node B").
- [ ] Implement "export to image" feature that allows users to export the current map view as a PNG or JPEG image
- [ ] Implement "read history" where, in playing mode, the user can see a list of nodes they have visited and read visually by seeing where an icon indicator is shown or not (exclamation icon for unread, nothing for read)
- [ ] Implement typewriter animation for notes in the Note Viewer Modal (note: once a note has been viewed, it doesn't play the animation again, it just shows the full note text)
- [ ] Create and import custom chevron icon for edge arrows that more closely matches the original source material
- [ ] Fix issue for some devices where, when already zoomed into a node in playing mode after having selected a node, and then clicking on another node, the camera attempts to "zoom out" and "zoom in" at the same time. Instead, it should just smoothly pan and zoom to the newly selected node, and then, when closing the note viewer modal, it should smoothly pan and zoom back out to the previous non-zoomed in zoom level (but centered on the last selected node, not the first selected node)
- [ ] Fix bug where map rotations don't relocate edge note counts to be correctly placed above the edge in its center and instead place them way off to the side
- [ ] Fix bug where, in editing mode, closing the note editor modal doesn't unfocus the edit node title label text input, but it should unfocus and undo any changes if the user hasn't pressed Enter or the check "confirm button"
- [x] Implement "F" shortcut to fit graph to screen
- [ ] Fix bug where, when zooming into a node, the bg image is not also zoomed into the correct location, but it should be
- [x] Fix bug where, when undoing a node move change, the edge note count node doesn't move back to its correct position, but it should
- [x] Implement CDN link validation to ensure that the provided CDN link appears to be a validly correctly formed URL
- [ ] Implement CDN link testing/verification to make sure that the provided CDN link is reachable and contains a valid JSON map file
- [x] Fix bug where modifying a graph in editing mode in any way appears to disable (turn off visually) note count nodes (and the note counts on is still toggled) but the note count nodes should be unaffected visually unless a node was deleted with notes on it
- [x] Fix bug where back button can't take you back to a previous map loaded from query params, but it should be able to (i.e. creating a new blank map should delete the previous/current map address from local storage)
- [x] Fix bug where when deleting a node that the orphaned note count nodes are not also visually deleted, but they should be
- [ ] Implement default menu UI state that can show simply the hamburger icons instead of hamburger icons + words with toggle button "Min UI" / "Max UI" in the Universal Controls section
- [x] Implement zoom to fit animation that smoothly zooms and pans the camera to fit the entire graph in the viewport when clicking the "fit to screen" button or pressing the "F" key (use the already built zoom animation from zooming to fit a node/edge/selection)
- [x] make it so that, when clicking on a place name suggestion (but not a hashtag), the app immediately searches for the place clicked
- [x] make it so that, once hashtags have been selected that it only takes one extra press of enter to do the search, and not 2 more presses
- [ ] add the abode, the puppy house, the dog house, milking stanchion 2, the 2 water tanks by the Octagon for GYG map 
- [ ] replace custom styling with tachyons as much as possible
- [ ] implement check that query params CDN match current map CDN, and if they don't, ask the user which map they want to use (current map in local storage or new map from query params CDN), load the correct map, and clear local storage (except for last used CDN URL) if the user chooses the query params CDN map
- [ ] Implement "guided tours" through maps which can be created in editing mode and then played in playing mode, where a guided tour is a series of nodes that are connected in a specific order, and the user can click "next" and "previous" to navigate through the tour, with the camera automatically zooming and panning to each node in the tour as it is navigated to
- [ ] Implement "zen" mode which makes the UI even more collapsed and less intrusive
- [x] Implement "help"/"info" modal which gives useful info about the app
- [ ] Fix bug where resizing a node from double to half size leaves the unseen badge in the wrong position
- [x] Hide unseen badges in editing mode, they should only be shown in playing mode
- [x] Fix bug where renaming a node appears to delete notes on connecting edges, but no edge notes should be deleted when renaming a node
- [x] Change camera display panel so that map name and CDN cannot be changed in playing mode, give tooltip to suggest changing modes in order to change
- [ ] Refactor code so that the background image is in a singular node that can be resized and repositioned via the same interface (bg img settings modal)

Notes for Future Features
- Listing out "layers" which show things such as electrical lines, water lines, Internet, etc. that can be toggled on and off
- Orientation layer/mode which shows the relevant info for orienting newcomers to the map, similar to a park map, and showing icons that will quickly orient the user to thing such as the entrance, exits, restrooms, kitchens, showers, etc.

Ideas
- Create "Guided Tours"
- Allow "hash-tag" style navigation within the map via hash-tags in the notes, that further allow hyperlink clicking to jump visually from one node to another, and a back button to return to the previous node(s)